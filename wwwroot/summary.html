<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <script>
        window.onload = function () {

            let queryString = getQueryString();

            fetch("api/DayTrunOver/GetDayTurnOver?" + queryString,
                {
                    method: "GET",
                    //body: queryString
                })
                .then(response => response.json())
                .then(data => setPageValues(data))
                .catch(error => console.error('Unable get balance.', error));
        
        };

        function getQueryString() {
            let sessionKey = localStorage.getItem("sessionKey");
            console.log("Session Key:");
            console.log(sessionKey);
            let queryString = "sessionKey=" + sessionKey;
            queryString += "&date=" + "12-11-2021";
            //queryString += "&date=" + formatDate(new Date());
            return queryString;
        }

        // converts the date object in "mm-dd-yyyy" string 
         function formatDate(d) {
            var mm = d.getMonth() + 1; // getMonth() is zero-based
            var dd = d.getDate();

            return [
                (mm > 9 ? '' : '0') + mm,
                (dd > 9 ? '' : '0') + dd,
                d.getFullYear()
            ].join('-');
        };

        function setPageValues(resp) {
            console.log(resp);
            let dateField = document.getElementById("Date");
            dateField.innerHTML = resp.setDateTime;

            let beginningBalanceField = document.getElementById("BegginningBalance");
            beginningBalanceField.innerHTML = resp.beginningBalance;

            let currentBalanceField = document.getElementById("CurrentBalance");
            currentBalanceField.innerHTML = resp.currentBalance;

            let currentIncomesld = document.getElementById("Incomes");

            for (var i = 0; i < resp.incomes.length; i++) {
                var p = document.createElement("p");
                //p.classList += 'album'; 
                p.innerHTML = '<h2>' + resp.incomes[i].title + " " + resp.incomes[i].value + '</h2>';
                //attr.value = "container";
                currentIncomesld.appendChild(p); 
            }


            let currentExpensesld = document.getElementById("Expenses");

            for (var i = 0; i < resp.expenses.length; i++) {
                var p = document.createElement("p");
                //p.classList += 'album'; 
                p.innerHTML = '<h2>' + resp.expenses[i].title + " " + resp.expenses[i].value + '</h2>';
                //attr.value = "container";
                currentExpensesld.appendChild(p);
            }

        }

    </script>
</head>
<body>
    <h1>Daily Balance</h1><h3 id="Date"></h3>
    <h3>Begginning balance:</h3><h3 id="BegginningBalance"></h3>
    <h3>Income:</h3>
    <div id="Incomes">

    </div>
    <h3>Expense:</h3>
    <div id="Expenses">

    </div>
    <h3>Current balance:</h3><h3 id="CurrentBalance"></h3>


</body>
</html>